6.2 The SR2 Method
=====================================

There is in fact a simpler rank-1 update for :math:`B_k` that maintains symmetry of the matrix and allows it to satisfy the secant equation. However, this **symmetric-rank-1**, or SR1, update does not guarantee that the updated matrix maintains positive definiteness.

The symmetric rank-1 update has the general form

.. math::

  B_{k+1} = B_k + \sigma vv^\top

where :math:`\sigma = \pm 1` and :math:`\sigma` and :math:`v` are chosen so that :math:`B_{k+1}` satisfies the secant equation :math:`y_k = B_{k+1}s_k`. By substituting into this equation, we obtain

.. math::

  y_k = B_ks_k + [\sigma v^\top s_k] v

Since :math:`\sigma v^\top s_k` is a scalar, :math:`v` must be a multiple of :math:`y_k - B_ks_k`. Let :math:`v = \delta (y_k - B_ks_k)`. It follows that

.. math::

  (y_k - B_ks_k) = \sigma \delta^2 \left[ s_k^\top (y_k - B_ks_k) \right](y_k - B_ks_k)

This equation is satisfied if and only if we choose

.. math::

  \sigma = \text{sign} \left[s_k^\top (y_k - B_ks_k)\right], \;\;\; \delta = \pm \left\lvert s_k^\top (y_k - B_ks_k) \right\rvert^{-1/2}

Hence we have shown that the only symmetric rank-1 updating formula that satisfies the secant equation is given by

.. math::

  \text{(SR1)} \;\;\; B_{k+1} = B_k + \frac{(y_k - B_ks_k)(y_k - B_ks_k)^\top}{(y_k - B_ks_k)^\top s_k}

By applying the Sherman-Morrison formula, we obtain the updating formula for the inverse Hessian approximation :math:`H_k`:

.. math::

  \text{(SR1)} \;\;\; H_{k+1} = H_k + \frac{(s_k - H_ky_K)(s_k - H_ky_k)^\top}{(s_k - H_ky_k)^\top y_k}
